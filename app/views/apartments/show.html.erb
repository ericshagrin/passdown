<div>
  <div>
    <h1>
      Apartment #<%= @the_apartment.id %> details
    </h1>

    <div>
      <div>
        <a href="/apartments">
          Go back
        </a>
      </div>

  <%begin %>
  <% if @current_user.id == @the_apartment.user_id%>
      <div>
        <a href="/delete_apartment/<%= @the_apartment.id %>">
          Delete apartment
        </a>
      </div>
    </div>
  <%end %>
  <%rescue%>
  <%end%>

    <dl>
      <dt>
        Price
      </dt>
      <dd>
        <%= @the_apartment.price %>
      </dd>

      <dt>
        Location
      </dt>
      <dd>
        <%= @the_apartment.location %>
      </dd>

      <dt>
        Num bath
      </dt>
      <dd>
        <%= @the_apartment.num_bath %>
      </dd>

      <dt>
        Num bdrms
      </dt>
      <dd>
        <%= @the_apartment.num_bdrms %>
      </dd>

      <dt>
        Furniture amt
      </dt>
      <dd>
        <%= @the_apartment.furniture_amt %>
      </dd>

      <dt>
        Status
      </dt>
      <dd>
        <%= @the_apartment.status %>
      </dd>

      <dt>
        Description
      </dt>
      <dd>
        <%= @the_apartment.description %>
      </dd>

      <dt>
        Interested buyers count
      </dt>
      <dd>
        <%= @the_apartment.interested_buyers_count %>
      </dd>

      <dt>
        Created at
      </dt>
      <dd>
        <%= time_ago_in_words(@the_apartment.created_at) %> ago
      </dd>

      <dt>
        Updated at
      </dt>
      <dd>
        <%= time_ago_in_words(@the_apartment.updated_at) %> ago
      </dd>
    </dl>
  </div>
</div>

<hr>

<% if @current_user != NULL%>
<div>
  <div>
    <h2>
      Edit apartment
    </h2>

    <form action="/modify_apartment/<%= @the_apartment.id %>"  method="post" >
      <div>
        <label for="price_box">
          Price
        </label>

        <input type="text" id="price_box" name="query_price" value="<%= @the_apartment.price %>">
      </div>

      <div>
        <label for="location_box">
          Location
        </label>

        <input type="text" id="location_box" name="query_location" value="<%= @the_apartment.location %>">
      </div>

      <div>
        <label for="num_bath_box">
          Number bath
              <select name="query_num_bath" id="num_bath_box">
                <option disabled selected value> <%=@the_apartment.num_bath%> </option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
            </select>
        </label>
      </div>

      <div>
        <label for="num_bdrms_box">
            Number of Bedrooms
            <select name="query_num_bdrms" id="num_bdrms_box">
                <option disabled selected value> <%=@the_apartment.num_bdrms%> </option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
            </select>
        </label>

      </div>

      <div>
        <label for="furniture_amt_box">
            Amount of Furniture 
            <select name="furniture_amt_box" id="query_furniture_amt">
              <option disabled selected value> <%= @the_apartment.furniture_amt%> </option>
              <option value="fully_furnished">Fully Furnished</option>
              <option value="mostly_furnished">Fully Unfurnished</option>
              <option value="mostly_unfurnished">Mostly Unfurnished</option>
              <option value="unfurnished">Unfurnished</option>
          </select>
        </label>
        </label>

      </div>

      <div>
        <label for="status_box">
          Status
            <select name="query_status" id="status_box">
              <option disabled selected value> <%= @the_apartment.status%> </option>
              <option value="Looking for a Tenant">Fully Furnished</option>
              <option value="In talks ">Fully Unfurnished</option>
              <option value="Passed Down">Mostly Unfurnished</option>
          </select>
        </label>
      </div>

      <div>
        <label for="description_box">
          Description
        </label>

        <input type="text" id="description_box" name="query_description" value="<%= @the_apartment.description %>">
      </div>

      <div>
        <label for="photos_count_box">
          Photos count
        </label>

        <input type="text" id="photos_count_box" name="query_photos_count" value="<%= @the_apartment.photos_count %>">
      </div>


      <button>
        Update apartment
      </button>
    </form>
  </div>
</div>
<%end%>

<hr>

<% if !@current_user or @current_user.id != @the_apartment.user_id %>
<div>
  <div>
    <h2>
      Add a new interested buyer
    </h2>

    <form action="/insert_interested_buyer" method="post" >

      <div>
        <input type="hidden" id="apt_id_box" name="query_apt_id" value="<%=@the_apartment.id%>">
      </div>
      <div>


      <div>
        <label for="email_box">
          Email
        </label>

        <input type="text" id="email_box" name="query_email">
      </div>

      <div>
        <label for="name_box">
          Name
        </label>

        <input type="text" id="name_box" name="query_name">
      </div>

      <div>
        <label for="phone_number_box">
          Phone number
        </label>

        <input type="text" id="phone_number_box" name="query_phone_number">
      </div>

      <button>
        Create interested buyer
      </button>
    </form>
  </div>
</div>

<hr>
<div>
  <div>
    <table>
      <tr>
        <th>
          ID
        </th>

        <th>
          Apt
        </th>

        <th>
          Email
        </th>

        <th>
          Name
        </th>

        <th>
          Phone number
        </th>

        <th>
          Created at
        </th>

        <th>
          Updated at
        </th>

        <th>
        </th>
      </tr>

<%end%>


<%if @list_of_interested_buyers != nil%>
<%if @current_user.id != @the_apartment.user_id%>
      <% @list_of_interested_buyers.each do |an_interested_buyer| %>
      <tr>
        <td>
          <%= an_interested_buyer.id %>
        </td>

        <td>
          <%= an_interested_buyer.apt_id %>
        </td>

        <td>
          <%= an_interested_buyer.email %>
        </td>

        <td>
          <%= an_interested_buyer.name %>
        </td>

        <td>
          <%= an_interested_buyer.phone_number %>
        </td>

        <td>
          <%= time_ago_in_words(an_interested_buyer.created_at) %> ago
        </td>
        <td>
          <%= time_ago_in_words(an_interested_buyer.updated_at) %> ago
        </td>

        <td>
          <a href="/interested_buyers/<%= an_interested_buyer.id %>">
            Show details
          </a>
        </td>
      </tr>
      <% end %>
    </table>
  </div>
<%end%>
<%end%>

</div>


<hr>
